<!DOCTYPE html>
<html lang="en">

<!--
TowerScout
A tool for identifying cooling towers from satellite and aerial imagery

TowerScout Team:
Karen Wong, Gunnar Mein, Thaddeus Segura, Jia Lu

Licensed under CC-BY-NC-SA-4.0
(see LICENSE.TXT in the root of the repository for details)
-->



<head>
  <title>TowerScout</title>
  <link rel="stylesheet" media="screen and (min-device-width: 1200px)" href="/css/ts_styles.css">
  <link rel="stylesheet" media="screen and (max-device-width: 1200px)" href="/css/ts_styles_mobile.css">
  <link rel="stylesheet" href="https://atlas.microsoft.com/sdk/javascript/mapcontrol/3/atlas.min.css" type="text/css">
  <link rel="stylesheet" href="https://atlas.microsoft.com/sdk/javascript/drawing/1/atlas-drawing.min.css" type="text/css" />
  <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/smoothness/jquery-ui.css">
</head>

<body style="margin:0 0 0 0;"  onload="initAzureMap()">
  </head>

<body style="margin:0 0 0 0;">

  <div id="fatal_div"
    style="display:none;z-index:2000;position:absolute; justify-content:center; align-items: center;top:0px; left:0px;width:100%;height:100%; background-color: lightgrey; opacity: 0.95; color:black">
    <div style="width:30%;height:12%">
      <center>
        Tile limit for this session exceeded. Please close this browser window.
      </center>
    </div>
  </div>
  <div id="progress_div"
    style="display:none;z-index:2000;position:absolute; justify-content:center; align-items: center;top:0px; left:0px;width:100%;height:100%; background-color: lightgrey; opacity: 0.7;">
    <div style="width:30%;height:12%">
      <progress id="progress" style="width:100%; vertical-align:middle;height:50%" max="100" value="0">
      </progress>
      <br>
      <center>
        <button onclick="cancelRequest()">Cancel</button>
      </center>
    </div>
  </div>
  <div class="grid-container">

    <div class="fheader" style="width: 100%;">
      TowerScout
      <a class="hover" href="{{ url_for('about') }}" target="_blank">About TowerScout</a>
     </div><br>
     

    <div class="fsearch">
      <div id="mapsearchui" style="display:block;height:auto">
        <span id="location">Location:&nbsp;</span>
        <div id="bingSearchBoxContainer" style="display:none;">
        <input type="text" aria-labelledby="location" id="bingSearch" placeholder="Search ..."/> </div>
        <div id="azureSearchBoxContainer" style="display:inline;">
          <input type="text" aria-labelledby="location" id="azureSearch" placeholder="Search ..."/> </div>
        <span style="float: right;" id="geometry">
          <input type='text' aria-labelledby="radiusbutton" id='radius' style='width:20%;vertical-align:10%'>&nbsp;
          <button onclick="circleBoundary()" id="radiusbutton" style="vertical-align:10%;">Circle</button>
          <span
            style="display: inline-block; width:1px; height:80%; vertical-align:-8%; background:white; margin: 0 2px;">&nbsp;</span>
          <button onclick="drawnBoundary()" id="drawnbutton" style="vertical-align:10%;">Custom shape</button>
          <span
            style="display: inline-block; width:1px; height:80%; vertical-align:-8%; background:white; margin: 0 2px;">&nbsp;</span>
          <button onclick="clearBoundaries()" style="vertical-align:10%;">Clear</button>
        </span>
      </div>
      <div id="uploadsearchui" style="display:none;">
        <lable id="lblUploadFile" for="upload_file">File:</lable>
        <input aria-labelledby="lblUploadFile" type="file" id="upload_file" style="width:80%;vertical-align:10%;" placeholder="Upload ...">
      </div>
    </div>

    <div id="fversion" class="fversion" style="text-align: right;">
     <span style="display: block;width: 100%;"><label id="lblazmaptransactions" style="width: 100%; display: block;">Azure map Transaction count</label></span>
    </div>
    

    <div class="fmodel" style="font-size:smaller; overflow-y:hidden;white-space: nowrap; overflow-x: hidden;">
      Search Area: <br>
     
        <input type="radio" id="nonrural" value="nonrural" onclick="ToggleSearchArea('nonrural')" checked>
        <label for="nonrural">Urban/Suburban</label><br>
        <input type="radio" id="rural" onclick="ToggleSearchArea('rural')" value="rural">
        <label for="rural">Rural</label>
     
      <br><br>
      User interface:<br>
      <form id="uis" name="uis">
        <!-- <input type="radio" id="google" name="uis" value="google" checked> -->
        <!-- <label for="google">Google Maps</label><br> -->
        <input type="radio" id="azure" name="uis" value="azure" checked>
        <label for="azure">Azure Maps</label><br>
        <input type="radio" id="bing" name="uis" value="bing" >
        <label for="bing">Bing Maps</label><br>
        <!-- <input type="radio" id="upload" name="uis" value="upload">
        <label for="upload">Image upload</label>
        <br> -->
      </form>
      <br>
      Backend map provider:<br>
      <br>
      <form id='providers' name='providers'>
      </form>
      <br>
      <label style="float: left;">Cluster Status:</label>
      <label id="lblClusterStatusValue" style="color: white;"></label><br><br>
      <label>Cluster Status last updated:</label><br>
      <label id="lblClusterStatusDtTime" style="display: none;"></label><br><br>
      <button id="btnGetClusterStatus" class="btn" onclick='getClusterStatusjs()' style="display: none;">Refresh Cluster Status</button><br><br>
      <label id="lblSearchStartTime" style="display: none;"></label><br><br>
      <label id="lblSearchEndTime" style="display: none;"></label><br><br>
    </div>
   
   
    <!--The div element for the map -->
    <div class="fmap" style="overflow-y:hidden;white-space: nowrap; overflow-x: hidden;">
      <!-- <div id="googleMap" style="display:block"></div> -->
       <div id="azureMap" aria-label="Current map view: Road view showing main roads and routes." style="display:none"></div>
       <div id="bingMap" aria-label="Current map view: Road view showing main roads and routes." style="display:none"></div>
      <div id="uploadMap" style="display:none; overflow-y:scroll">
        <img id="canvas" alt="Map Canvas" style="width:100%;">
      </div>
    </div>

    <div class="fdetect" id="fdetect">
      <button id="btnTest" style="display: none;" class="btn" onclick='drawBoundingBoxesTest()'>Find Test towers</button>
      <button id="btnTestGold" style="display: none;" class="btn" onclick='drawBoundingBoxesGoldTable()'>Find Gold towers</button>
      <button id="estimate" class="btn" onclick='ProcessUserRequest(true)'>Estimate tiles</button>
      <button id="find" class="btn" onclick='ProcessUserRequest()'>Find towers</button>
      
      
    </div>

    <div class="ffilter" id="ffilter" style="font-size: smaller;display:none">
      <label id="lblConf" for="conf"> Min. Confidence:&nbsp;</label><input aria-labelledby="lblConf" type="range" min="0" max="100" value="35" class="slider" id="conf"
         style="vertical-align:-25%; width:60%">
       &nbsp;<span style="float:right">&nbsp;%</span><span id='confpercent' style="float:right">35</span><br>
       <!-- <input type="checkbox" id="inside" checked style="vertical-align:-10%">&nbsp;Enforce boundary -->
     </div>

     <div class="freview" id="freview" style="font-size: smaller;">
      <span style="float: left;">
        <button onclick="Detection.prev()">&lt;</button>
       <label id="lblDet" for="detection"> Det. </label><input aria-labelledby="lblDet" type="text" id="detection" style="width:30px;"
          onkeydown="if (event.keyCode == 13) { Detection.number(); return false; }">&nbsp;
        <button onclick="Detection.next()">&gt;</button>
      </span>
      <lable id="lblFind">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Find&nbsp;</lable>
      
      <label class="switch" style="vertical-align:-8%">:
        <input aria-labelledby="lblFind" type="checkbox" id="review">
        <span class="knob round"></span>
      </label>
      &nbsp;:Label
      <span style="float: right;">
        <button onclick="Tile.prev()">&lt;</button>
       <label id="lblTile" for="tile"> Tile </label><input aria-labelledby="lblTile" type="text" id="tile" style="width:30px;"
          onkeydown="if (event.keyCode == 13) { Tile.number(); return false; }">&nbsp;
        <button onclick="Tile.next()">&gt;</button></span>
    </div>


    <div class="ftowers" id="ftowers" style="overflow-y: hidden;">
      <p id="checkBoxes"
        style="margin: 0px; overflow-y:scroll; width:100%; height:100%;white-space: nowrap; overflow-x: hidden;">
      </p>
    </div>

    <div class="fadd" id="fadd" style="overflow-y:hidden;white-space: nowrap; overflow-x: hidden;font-size: smaller;">
      <button id="addbutton" class="btn" onclick="currentMap.addShapes()" style="width:33%; height:100%">Add
        locations</button>
      <button class="btn" onclick="currentMap.clearShapes()" style="width:33%; height:100%">Clear</button>
      <button class="btn" onclick="currentMap.clearAll()" style="width:33%; height:100%">Clear all</button>
    </div>

    <div class="fsave" id="fsave" style="overflow-y:hidden;white-space: nowrap; overflow-x: hidden;font-size: smaller;">
      <button class="btn" onclick="download_csv(),download_kml()" style="width:50%; height:100%">Download
        results</button>
      <button class="btn" onclick="PromoteSilverToGold()" style="width:50%; height:100%">Promote to Gold</button>
     
    </div>

    <div class="ftext" style="font-size: smaller;">
      <p id="output"
        style="margin: 0px; overflow-y:scroll; width:100%; height:100%; white-space: nowrap; overflow-x: hidden;font-size:smaller;">
      </p>
    </div>
  </div>

<div id="mapContextMenu" style="
    position: absolute;
    display: none;
    color: black;
    background-color: white;
    border: 1px solid #ccc;
    padding: 5px 10px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.3);
    cursor: pointer;
    z-index: 1000;
">
  <div id="coordText">Copy coordinates</div>
  
</div>


  <script src="/js/jquery-3.5.1.min.js"></script>
  <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
  <script type='text/javascript' src='https://www.bing.com/api/maps/mapcontrol?key={{bing_map_key}}'
    async defer>
    </script>
    <script src="https://atlas.microsoft.com/sdk/javascript/mapcontrol/3/atlas.min.js"></script>
    <script src="https://atlas.microsoft.com/sdk/javascript/drawing/1/atlas-drawing.min.js"></script>
    <script>
      let bak = "{{bing_map_key}}";
      let azure_api_key = "{{azure_map_key}}";
      let dev = "{{ dev }}";
   </script>
  <script src="/js/towerscout.js"></script>
</body>

</html>
